<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RogueDeck</title>
	<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
	<style>
		.disabled {
		}

			.disabled:after {
				display: block;
				position: absolute;
				height: 100%;
				width: 100%;
				background-color: Black;
				opacity: .2;
				content: ' ';
				top: 0px;
				left: 0px;
				z-index: 99;
			}

		div#MessageLogDiv {
			margin-top: 20px;
		}

			div#MessageLogDiv .alert {
				margin-bottom: 5px;
			}

		#AlertDiv {
			width: 500px;
			height: 200px;
			margin: 0 auto;
			background: #f7f7f7;
			position: absolute;
			left: 50%;
			top: 50%;
			margin-left: -250px;
			margin-top: -100px;
			z-index: 100;
			text-align: center;
			display: none;
			border: solid 2px red;
			opacity: .8;
		}

		#AlertMsg {
			text-align: center;
			line-height: 160px;
		}

		.statusAlert {
			background-color: rgba(255, 0, 0, .3);
		}
	</style>
</head>
<body>
	<div class="container">
		<div id="AlertDiv">
			<div id="AlertMsg"></div>
			<button data-bind="click: startNewGame">OK</button>
		</div>
		<div class="row">
			<h1>RogueDeck</h1>
		</div>
		<div class="row" data-bind="with: currentAreaCard">
			<div class="col-sm-4" id="AreaDiv">
				<h3>Area</h3>
				<div>
					<h4>You are in a <span data-bind="text: sizeText"></span> <span data-bind="text: type"></span></h4>
					<ul class="doorsList" data-bind="foreach: doors, css: { disabled: monsters().length > 0 }">
						<li>There is a door to the <a href="javascript:void(0);" data-bind="text: direction, click:window.rogueGame.tryMoveToNewArea"></a></li>
					</ul>
				</div>
			</div>
			<div class="col-sm-4" id="MonstersDiv">
				<h3>Monsters</h3>
				<div class="row">
					<!-- ko foreach: monsters -->
					<div class="col-sm-4">
						<h4 data-bind="text:type"></h4>
						<div>
							Att: <span data-bind="text: attack"></span>, Def: <span data-bind="text:defense"></span>
						</div>
						<div>
							HP: <span data-bind="text: hitPoints"></span>
						</div>
						<div>
							<a href="javascript:void(0);" data-bind="click: window.rogueGame.processPlayerAttack">Attack!</a>
						</div>
						<div data-bind="html: fightLog" style="max-height: 200px; overflow-y: scroll;">
						</div>
					</div>
					<!-- /ko -->
				</div>
			</div>
			<div class="col-sm-4" id="LootDiv">
				<h3>Loot</h3>
				<ul data-bind="foreach: loot">
					<li><span data-bind="text: droppedBy"></span> <span data-bind="text:type"></span> <span class="badgesSpan" data-bind="if: value && value.buffs"><span data-bind="template: { name: 'BuffsBadgesTemplate', foreach: value.buffs }"></span></span> here. <a href="javascript:void(0);" data-bind="click:window.rogueGame.takeItem">Take</a></li>
				</ul>
			</div>
		</div>
		<div class="row" data-bind="with:player">
			<h3>Player: <span data-bind="text: name"></span></h3>
			<div class="col-sm-3">
				<h3>Stats</h3>
				<table>
					<tr>
						<th>Strength</th>
						<td data-bind="text: strength"></td>
					</tr>
					<tr>
						<th>Intelligence</th>
						<td data-bind="text: intelligence"></td>
					</tr>
					<tr>
						<th>Dexterity</th>
						<td data-bind="text: dexterity"></td>
					</tr>
					<tr>
						<th>Vitality</th>
						<td data-bind="text: vitality"></td>
					</tr>
				</table>
				<div data-bind="visible: rogueGame.curTurnIndex() < 2">
					<input type="button" value="Re-roll" data-bind="click: rogueGame.rerollCharacter" />
				</div>
			</div>
			<div class="col-sm-3" data-bind="css: { statusAlert: hitPoints() < 12 || stomach() < 12 }">
				<h3>Vitals</h3>
				<table>
					<tr data-bind="css: { statusAlert: hitPoints() < 12 }">
						<th>Hit Points</th>
						<td><span data-bind="text:hitPoints"></span>(/<span data-bind="text:maxHitPoints"></span>)</td>
					</tr>
					<tr data-bind="css: { statusAlert: stomach() < 12 }">
						<th>Stomach</th>
						<td><span data-bind="text:stomach"></span>(/<span data-bind="text:maxStomach"></span>)</td>
					</tr>
				</table>
			</div>
			<div class="col-sm-3">
				<h3>Inventory</h3>
				<ul data-bind="foreach: lootCards">
					<li>
						<span data-bind="text: type"></span> <span class="badgesSpan" data-bind="if: value.buffs"><span data-bind="template: { name: 'BuffsBadgesTemplate', foreach: value.buffs }"></span></span>
						[<a href="javascript:void(0);" data-bind="text: verb, click:window.rogueGame.useItem"></a>]
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<h3>Equipped</h3>
				<ul>
					<li><strong>Right-Hand:</strong> <span data-bind="text: weapon().displayName"></span><span class="badgesSpan" data-bind="template: { name: 'BuffsBadgesTemplate', foreach: weapon().buffs }"></span> (Dmg: <span data-bind="text: weapon().totalToHit"></span>)</li>
					<li><strong>Armor:</strong> <span data-bind="text: armor().displayName"> </span><span class="badgesSpan" data-bind="template: { name: 'BuffsBadgesTemplate', foreach: armor().buffs }"></span> (Def: <span data-bind="text: armor().totalDefense"></span>)</li>
				</ul>
			</div>
		</div>
		<div class="row" id="MessageLogDiv" data-bind="foreach: messageLog">
			<div data-bind="attr: { class: 'alert alert-' + $data.level }">
				<div class="col-sm-1"><span class="badge" data-bind="text:$data.index"></span></div><div class="col-sm-11"><span data-bind="text:$data.message"></span></div><div style="clear: both"></div>
			</div>
		</div>
		<div class="row" data-bind="visible: messageLog().length > 0">
			<a href="javascript:void(0)" data-bind="click: window.rogueGame.clearMessageLog">Clear all messages</a>
		</div>
	</div>

	<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
	<script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-3.0.0.js"></script>
	<script src="scripts/utils.js"></script>
	<script src="scripts/rogueDeckDictionary.js"></script>
	<script src="scripts/rogueDeckGame.js"></script>
	<script type="text/javascript" id="PageCode">
		$(document).ready(function () {
			rogueGame.startGameAndGetFirstRoom();
			ko.applyBindings(window.rogueGame);
		});
	</script>
	<!-- Named Templates -->
	<script type="text/html" id="BuffsBadgesTemplate">
		<span data-bind="text: displayName" class="badge"></span>
	</script>
</body>
</html>